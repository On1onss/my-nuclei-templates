id: PortSwigger_Lab_Exploiting_web_cache_deception
info:
  name: Lab Exploiting for Web Cache Deception
  author: Bb0LP
  severity: medium
  description: |
    Check for web cache deception by testing various delimiters in the path.
  tags: web, ctf, labs

http:
  - method: GET
    path:
      - "{{BaseURL}}/my-account{{delimiter}}test.js"
    headers:
      Accept: text/html
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36
    payloads:
      delimiter:
        - '!'
        - '\'
        - '#'
        - '$'
        - '%'
        - '&'
        - '('
        - ')'
        - '*'
        - '+'
        - ','
        - '-'
        - '.'
        - '/'
        - ':'
        - ';'
        - '<'
        - '='
        - '>'
        - '?'
        - '@'
        - '['
        - '\'
        - ']'
        - '^'
        - '_'
        - '`'
        - '{'
        - '|'
        - '}'
        - '~'
        - '%21'
        - '%22'
        - '%23'
        - '%24'
        - '%25'
        - '%26'
        - '%27'
        - '%28'
        - '%29'
        - '%2A'
        - '%2B'
        - '%2C'
        - '%2D'
        - '%2E'
        - '%2F'
        - '%3A'
        - '%3B'
        - '%3C'
        - '%3D'
        - '%3E'
        - '%3F'
        - '%40'
        - '%5B'
        - '%5C'
        - '%5D'
        - '%5E'
        - '%5F'
        - '%60'
        - '%7B'
        - '%7C'
        - '%7D'
        - '%7E'

    stop-at-first-match: false
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 302
      - type: word
        part: header
        words:
          - "Cache-Control"
          - "X-Cache"

